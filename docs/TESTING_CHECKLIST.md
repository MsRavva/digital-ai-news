# Чеклист тестирования после миграции

## Предварительная настройка

- [ ] Переменные окружения настроены в `.env.local`
- [ ] OAuth провайдеры (Google, GitHub) настроены в Supabase Dashboard
- [ ] Приложение запущено (`npm run dev`)

## Тестирование аутентификации

### Email/Password регистрация
- [ ] Открыть `/register`
- [ ] Заполнить форму с валидными данными:
  - Email: test@example.com
  - Имя: Иван Иванов (на русском)
  - Пароль: test123456
- [ ] Нажать "Зарегистрироваться"
- [ ] Проверить, что пользователь создан в Supabase Dashboard → Authentication → Users
- [ ] Проверить, что профиль создан в таблице `profiles`
- [ ] Проверить редирект на главную страницу

### Email/Password вход
- [ ] Открыть `/login`
- [ ] Ввести email и пароль зарегистрированного пользователя
- [ ] Нажать "Войти с Email"
- [ ] Проверить успешный вход и редирект на главную

### Google OAuth
- [ ] Открыть `/login`
- [ ] Нажать "Продолжить с Google"
- [ ] Авторизоваться через Google
- [ ] Проверить редирект на `/auth/callback`
- [ ] Проверить, что пользователь создан в Supabase
- [ ] Если имя не соответствует формату "Имя Фамилия":
  - [ ] Проверить редирект на `/profile?update=username`
  - [ ] Обновить имя на валидное
  - [ ] Проверить успешное сохранение

### GitHub OAuth
- [ ] Открыть `/login`
- [ ] Нажать "Продолжить с GitHub"
- [ ] Авторизоваться через GitHub
- [ ] Проверить редирект на `/auth/callback`
- [ ] Проверить, что пользователь создан в Supabase
- [ ] Если имя не соответствует формату "Имя Фамилия":
  - [ ] Проверить редирект на `/profile?update=username`
  - [ ] Обновить имя на валидное
  - [ ] Проверить успешное сохранение

### Выход из системы
- [ ] Войти в систему
- [ ] Нажать кнопку выхода
- [ ] Проверить редирект на `/login`
- [ ] Проверить, что доступ к защищенным страницам закрыт

## Тестирование валидации

### Валидация имени пользователя
- [ ] Попробовать зарегистрироваться с именем на английском (должна быть ошибка)
- [ ] Попробовать зарегистрироваться с одним словом (должна быть ошибка)
- [ ] Попробовать зарегистрироваться с именем "Иван Иванов" (должно работать)

### Валидация email
- [ ] Попробовать зарегистрироваться без email (должна быть ошибка)
- [ ] Попробовать зарегистрироваться с невалидным email (должна быть ошибка)
- [ ] Попробовать зарегистрироваться с валидным email (должно работать)

### Валидация пароля
- [ ] Попробовать зарегистрироваться с паролем < 6 символов (должна быть ошибка)
- [ ] Попробовать зарегистрироваться с паролем >= 6 символов (должно работать)

## Тестирование профиля

### Просмотр профиля
- [ ] Войти в систему
- [ ] Открыть `/profile`
- [ ] Проверить, что отображаются текущие данные пользователя

### Обновление профиля
- [ ] Открыть `/profile`
- [ ] Изменить имя пользователя на валидное
- [ ] Нажать "Сохранить"
- [ ] Проверить, что данные обновились в Supabase
- [ ] Обновить страницу и проверить, что изменения сохранились

### Обновление email
- [ ] Открыть `/profile`
- [ ] Изменить email на новый
- [ ] Нажать "Сохранить"
- [ ] Проверить, что email обновился в Supabase

## Тестирование защиты маршрутов

### Защищенные маршруты (требуют авторизации)
- [ ] Выйти из системы
- [ ] Попробовать открыть `/` (должен редирект на `/login`)
- [ ] Попробовать открыть `/profile` (должен редирект на `/login`)
- [ ] Попробовать открыть `/create` (должен редирект на `/login`)
- [ ] Войти в систему
- [ ] Проверить, что все защищенные маршруты доступны

### Публичные маршруты
- [ ] Выйти из системы
- [ ] Открыть `/login` (должно работать)
- [ ] Открыть `/register` (должно работать)

## Тестирование базы данных

### Проверка RLS политик
- [ ] Войти в систему
- [ ] Создать пост (если есть функционал)
- [ ] Проверить, что пост виден только автору
- [ ] Попробовать отредактировать чужой пост (должна быть ошибка)

### Проверка trigger
- [ ] Зарегистрировать нового пользователя
- [ ] Проверить в Supabase Dashboard → Database → profiles
- [ ] Убедиться, что профиль создан автоматически
- [ ] Проверить, что поля заполнены корректно:
  - `id` = user.id из auth.users
  - `username` = имя из формы
  - `email` = email из формы
  - `role` = "student"
  - `created_at` = текущее время

## Тестирование ошибок

### Обработка ошибок аутентификации
- [ ] Попробовать войти с неверным паролем (должно быть понятное сообщение)
- [ ] Попробовать войти с несуществующим email (должно быть понятное сообщение)
- [ ] Попробовать зарегистрироваться с существующим email (должно быть понятное сообщение)

### Обработка сетевых ошибок
- [ ] Отключить интернет
- [ ] Попробовать войти (должно быть сообщение об ошибке)
- [ ] Включить интернет
- [ ] Проверить, что все работает

## Тестирование производительности

### Скорость загрузки
- [ ] Открыть DevTools → Network
- [ ] Обновить страницу `/login`
- [ ] Проверить, что страница загружается < 2 секунд
- [ ] Проверить, что нет лишних запросов

### Оптимизация запросов
- [ ] Открыть DevTools → Network
- [ ] Войти в систему
- [ ] Проверить, что запросы к Supabase минимальны
- [ ] Проверить, что нет дублирующихся запросов

## Миграция данных (если применимо)

### Миграция пользователей
- [ ] Запустить `npx tsx scripts/migrate-users.ts`
- [ ] Проверить логи на наличие ошибок
- [ ] Проверить в Supabase, что пользователи мигрированы
- [ ] Попробовать войти под мигрированным пользователем

### Миграция постов
- [ ] Запустить `npx tsx scripts/migrate-posts.ts`
- [ ] Проверить логи на наличие ошибок
- [ ] Проверить в Supabase, что посты мигрированы
- [ ] Проверить, что связи между пользователями и постами сохранены

## Финальная проверка

- [ ] Все тесты пройдены успешно
- [ ] Нет ошибок в консоли браузера
- [ ] Нет ошибок в логах Supabase
- [ ] Приложение работает стабильно
- [ ] Готово к продакшену

## Известные проблемы

Если обнаружены проблемы, запишите их здесь:

1. 
2. 
3. 

## Дополнительные заметки

Добавьте любые дополнительные заметки о тестировании:

-
-
-
